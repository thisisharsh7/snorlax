# ===========================================
# GitHub Issue Triage Assistant - Backend Configuration
# ===========================================

# ====================================
# REQUIRED CONFIGURATION
# ====================================

# DATABASE CONNECTION (REQUIRED)
# PostgreSQL connection string with pgvector extension
# Format: postgresql://username:password@host:port/database?sslmode=disable
APP_DATABASE_URL=postgresql://snorlax:snorlax_password@localhost:5432/snorlax?sslmode=disable

# ====================================
# SECURITY CONFIGURATION
# ====================================

# CORS ALLOWED ORIGINS (REQUIRED for production)
# Comma-separated list of allowed frontend URLs
# Development defaults are automatically added (localhost:3000, 127.0.0.1:3000)
# Example: https://app.yourdomain.com,https://www.yourdomain.com
ALLOWED_ORIGINS=http://localhost:3000

# GITHUB WEBHOOK SECRET (REQUIRED for webhook security)
# Generate a strong random secret: openssl rand -hex 32
# CRITICAL: Webhooks will be rejected if this is not set
# This must match the secret configured in GitHub webhook settings
GITHUB_WEBHOOK_SECRET=

# WEBHOOK PUBLIC URL (REQUIRED for production webhooks)
# The publicly accessible URL where GitHub can send webhooks
# Development: http://localhost:8000/api/webhooks/github
# Production: https://api.yourdomain.com/api/webhooks/github
WEBHOOK_URL=http://localhost:8000/api/webhooks/github

# ADMIN AUTHENTICATION (REQUIRED for Settings UI)
# Admin password for protecting sensitive endpoints (e.g., POST /api/settings)
# Generate a strong password: openssl rand -base64 32
# CRITICAL: Without this, settings endpoint will not work
ADMIN_PASSWORD=

# ADMIN USERNAME (Optional)
# Admin username for authentication (default: "admin")
# Only change if you need a custom admin username
ADMIN_USERNAME=admin

# ====================================
# OPTIONAL CONFIGURATION
# ====================================

# DATA DIRECTORY
# Local directory for cloning repositories and storing indexed files
# Default: ./data
DATA_DIR=./data

# ====================================
# API KEYS (Managed via Settings UI)
# ====================================
# DO NOT put API keys in this file!
# API keys should be configured through the Settings UI (⚙️ button in dashboard)
#
# Required API Keys:
# - Anthropic API Key: For AI-powered issue triage (get from https://console.anthropic.com/settings/keys)
# - GitHub Token (optional): For higher rate limits and posting comments (get from https://github.com/settings/tokens)
#
# These are stored encrypted in the database settings table

# ====================================
# PRODUCTION DEPLOYMENT CHECKLIST
# ====================================
# 1. ✅ Set strong ADMIN_PASSWORD (required for Settings UI)
# 2. ✅ Set strong GITHUB_WEBHOOK_SECRET
# 3. ✅ Configure ALLOWED_ORIGINS with your domain(s)
# 4. ✅ Set WEBHOOK_URL to your public API endpoint
# 5. ✅ Ensure APP_DATABASE_URL uses production credentials
# 6. ✅ Enable SSL/TLS on database connection (sslmode=require)
# 7. ✅ Configure API keys via Settings UI after deployment
# 8. ✅ Set up GitHub webhook in repository settings
# 9. ✅ Test webhook delivery in GitHub settings

# ====================================
# DEVELOPMENT SETUP
# ====================================
# For local development, you only need:
# 1. APP_DATABASE_URL (with local PostgreSQL + pgvector)
# 2. Start backend: uvicorn main:app --reload
# 3. Configure API keys via Settings UI at http://localhost:3000/dashboard
# 4. (Optional) Set GITHUB_WEBHOOK_SECRET for testing webhooks with ngrok/localtunnel
